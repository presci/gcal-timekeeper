<?xml version="1.0" encoding="UTF-8"?>
<Module>
<ModulePrefs title="My Time Organizer">
<Require feature="dynamic-height"/>
<Require feature="google.calendar-0.5"/>
</ModulePrefs>
<Content type="html"><![CDATA[

<div id="_p_content_div">  
<label>Event : </label><input type="text" id="event"></input><br/>
<label>Details : </label><input type="text" id="details"></input><br/>
<label>Days : </label><input type="text" id="days"></input><br/>
<label>Hours : </label><input type="text" id="hours"></input><br/>
<label>Minutes : </label><input type="text" id="mins"></input><br/>
<input type="button" id="save" value="Save" onclick="save()"></input>
<input type="button" id="cancel" value="cancel" onclick="cancel()"></input><br/>
<div id="saved_date"></div>

</div>



<script type="text/javascript">
Date.prototype.addHours=function(h){ var _H=h.ifBlankZero(); this.setTime(this.getTime() + ( _H * 60 * 60 * 1000)); return this; }
Date.prototype.addDays=function(D){ var _D=D.ifBlankZero(); this.setTime(this.getTime() + ( _D * 24 * 60 * 60 * 1000)); return this; }
Date.prototype.addMins=function(M){ var _M=M.ifBlankZero(); this.setTime(this.getTime() + (_M * 60 * 1000)); return this; }
String.prototype.ifBlankZero=function(){ if( this.replace(/\s/g,"") == ""){ return 0; } return this; }

function cancel(){
document.getElementById('event').value=''; document.getElementById('days').value=''; document.getElementById('hours').value=''; document.getElementById('mins').value='';
}

function save(){
// the function responsible for saving the data to calendar
var _event=document.getElementById('event').value; var _days=document.getElementById('days').value; var _hours=document.getElementById('hours').value; var _mins=document.getElementById('mins').value;
var _details=document.getElementById('details').value;
var _dt=new Date();
_dt=_dt.addDays(_days).addHours(_hours).addMins(_mins);
var ele=document.getElementById('saved_date');
ele.innerHTML=_dt;

var eventData={ 
title:_event,
details:_details,
location: 'computer',
allDay: false,
startTime: {year: _dt.getFullYear(), month:_dt.getMonth(), date: _dt.getDate(), hour:_dt.getHours() , minute:_dt.getMinutes() , second:0},
endTime: {year: _dt.getFullYear(), month:_dt.getMonth(), date: _dt.getDate(), hour: _dt.getHours(), minute:_dt.getMinutes(), second:0},
attendees:[{email:'p.c.iyer@gmail.com'}],
rrule: 'RRULE:FREQ=YEARLY'
};
console & console.info( eventData);

google.calendar.composeEvent(eventData);
}





   </script>
]]></Content>
</Module>
